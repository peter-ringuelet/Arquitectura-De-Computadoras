EOI EQU 20H
IMR EQU 21H
HAND_DATO EQU 40H
HAND_ESTADO EQU 41H
INT2 EQU 26H
N_HND EQU 10

ORG 40
IP_HND DW RUT_HND

ORG 1000H
MSJ DB "Aa"
FIN DB ?

ORG 3000H
SELECCIONADO: PUSH AX
MOV DL, 0
CMP BYTE PTR[BX], 41H
JS NO_SELECCIONADO
MOV AL, 5AH
CMP AL, BYTE PTR[BX]
JS NO_SELECCIONADO
MOV DL, 1
NO_SELECCIONADO: POP AX
RET

RUT_HND: CALL SELECCIONADO
CMP DL, 1
JNZ SALTEAR
MOV AL, [BX]
OUT HAND_DATO, AL
SALTEAR: INC BX
DEC CL
MOV AL, 20H
OUT EOI, AL
IRET

ORG 2000H
CLI
IN AL, HAND_ESTADO
OR AL, 10000000B
OUT HAND_ESTADO, AL
MOV AL, 11111011B
OUT IMR, AL
MOV AL, N_HND
OUT INT2, AL
MOV BX, OFFSET MSJ
MOV CL, OFFSET FIN - OFFSET MSJ
STI
LAZO: CMP CL, 0
JNZ LAZO
INT 0
END